EDITSUBAREAS:
  ON ERROR GOTO 0
  CLS
  GOSUB FILETEST
  C1=VAL(P4$(1)):C2=VAL(P4$(2)):C3=VAL(P4$(3)):C4=VAL(P4$(4))
  GOSUB HEADING
  GOSUB EDITHEADING
  GOSUB EDITMENU
  EDITENTER:
    LOCATE 16,35:Y1$="1":CALL PROM(Y1$,1,1)
    IF Y1$ = "1" THEN GOTO SUBAREAEDIT
    IF Y1$ = "2" THEN GOTO DELETESUBAREA
    IF Y1$ = "3" THEN GOTO INSERTSUBAREA
    IF Y1$ = "4" THEN GOTO START
  GOTO EDITENTER


EDITMENU:
  LOCATE 8,20: PRINT FNBOX$(39,10)
  LOCATE 9,27: PRINT "ENTER DESIRED FUNCTION"
  LOCATE 11,29 : PRINT "1) EDIT SUBAREA"
  LOCATE 12,29 : PRINT "2) DELETE SUBAREA"
  LOCATE 13,29 : PRINT "3) INSERT SUBAREA"
  LOCATE 14,29 : PRINT "4) EXIT TO MAIN MENU"
  LOCATE 16,27 : PRINT "NUMBER?"
RETURN



EDITHEADING:
  LOCATE 2,29:PRINT "SUBAREA EDIT ROUTINE"
RETURN

SUBAREAEDIT:
  LOCATE 22,12:PRINT "(ENTRY OF 'N1' WILL ALLOW SEQUENTIAL NUMBER TO BE EDITED)"
  LOCATE 21,17:PRINT "ENTER SUBAREA DESIGNATION TO BE EDITED: ";:A$="A1"
  CALL PROM(A$,4,2)
  IF A$="N1  " THEN
    LOCATE 21,17:PRINT "ENTER SEQUENTIAL NUMBER OF SUBAREA TO BE EDITED: ";:A$="1"
    LABEL2:
      LOCATE 21,66:CALL PROM(A$,1,1):I4%=VAL(A$):IF I4%=0 THEN LABEL2
      IF I4%>I2% THEN LABEL2
      GOSUB HEADING
      GOSUB EDITHEADING
      LOCATE 6,6:PRINT "ENTER SUBAREA DESIGNATION: ";:CALL PROM(A$(I4%),4,NUM%)
      LOCATE 6,6:PRINT "                                  "
      GOTO LABEL3
  END IF
  FOR I4%=1 TO I2%
    IF A$=A$(I4%) THEN LABEL3
  NEXT I4%
  GOTO EDITSUBAREAS
  LABEL3:
    GOSUB HEADING
    GOSUB EDITHEADING
    GOSUB ENTERCVALUE1
    LOCATE 23,25:PRINT"ENTER 'N' TO EXIT ";:Z$="N":CALL PROM(Z$,1,1)
    IF Z$<>"N" THEN
      GOTO LABEL3
    END IF
    IF TIMECONCTYPE$="1" THEN GOSUB EDIT1986CONCENTRATIONTIME
    IF TIMECONCTYPE$="2" THEN GOSUB EDITUPLANDCONCENTRATIONTIME
    GOSUB FLOWTOTALS
    LOCATE 22,28:PRINT "PRESS RETURN TO CONTINUE";:Y1$=" ":CALL PROM(Y1$,1,1)
GOTO EDITSUBAREAS

EDITUPLANDCONCENTRATIONTIME:
    CLS:GOSUB HEADING:J%=1:K%=1:N2%=6
    LOCATE 3,34:PRINT "SUBAREA ";A$(I4%)
    LOCATE 4,18:PRINT "TIME OF CONCENTRATION - SCS UPLAND METHOD"
    LOCATE 5,1 :PRINT FNBOX$(79,15)
    FOR K4% = 1 TO 4
      IF U%(I4%,K4%)=1 THEN GOSUB FOREST
      IF U%(I4%,K4%)=2 THEN GOSUB FALLOW
      IF U%(I4%,K4%)=3 THEN GOSUB GRASS1
      IF U%(I4%,K4%)=4 THEN GOSUB BARE
      IF U%(I4%,K4%)=5 THEN GOSUB WATERWAY
      IF U%(I4%,K4%)=6 THEN GOSUB PAVED
      IF U%(I4%,K4%)=7 THEN GOSUB OTHER
      IF U%(I4%,K4%)=0 THEN EXIT FOR
      IF L1#=0 THEN GOSUB DELETETCENTRY
    NEXT K4%
    START3:
      IF J%=5 THEN RETURN
      GOSUB FOREST
      IF J%=5 THEN RETURN
      GOSUB FALLOW
      IF J%=5 THEN RETURN
      GOSUB GRASS1
      IF J%=5 THEN RETURN
      GOSUB BARE
      IF J%=5 THEN RETURN
      GOSUB WATERWAY
      IF J%=5 THEN RETURN
      GOSUB PAVED
      IF J%=5 THEN RETURN
      GOSUB OTHER
      IF J%=5 THEN RETURN
    LOCATE 22,1:PRINT "ENTER MORE DATA? ";:Y1$="N":CALL PROM(Y1$,1,1)
    LOCATE 22,1:PRINT "                     "
    IF Y1$="Y" THEN GOTO START3
RETURN

EDIT1986CONCENTRATIONTIME:
    CLS:GOSUB HEADING:J%=1:K%=1:N2%=6
    LOCATE 3,34:PRINT "SUBAREA ";A$(I4%)
    LOCATE 4,18:PRINT "TIME OF CONCENTRATION - JUNE 1986 METHOD"
    LOCATE 5,1 :PRINT FNBOX$(79,15)
    FOR K4% = 1 TO 4
      IF U%(I4%,K4%)=1 THEN GOSUB OVERLAND
      IF U%(I4%,K4%)=2 THEN GOSUB CONCENTRATED
      IF U%(I4%,K4%)=3 THEN GOSUB CHANNEL
      IF U%(I4%,K4%)=4 THEN GOSUB OTHER1
      IF U%(I4%,K4%)=0 THEN EXIT FOR
      IF L1#=0 THEN GOSUB DELETETCENTRY
    NEXT K4%
    START1986A:
      IF J%=5 THEN RETURN
      GOSUB OVERLAND
      IF J%=5 THEN RETURN
      GOSUB CONCENTRATED
      IF J%=5 THEN RETURN
      GOSUB CHANNEL
      IF J%=5 THEN RETURN
      GOSUB OTHER1
      IF J%=5 THEN RETURN
    LOCATE 22,1:PRINT "ENTER MORE DATA? ";:Y1$="N":CALL PROM(Y1$,1,1)
    LOCATE 22,1:PRINT "                     "
    IF Y1$="Y" THEN GOTO START1986A
RETURN

DELETETCENTRY:
  ON ERROR GOTO 0
  IF K4%<4 THEN
    FOR K5% = K4% TO 3
      U%(I4%,K5%)=U%(I4%,K5%+1)
      T1$(I4%,K5%)=T1$(I4%,K5%+1)
      L$(I4%,K5%)=L$(I4%,K5%+1)
      S$(I4%,K5%)=S$(I4%,K5%+1)
      T#(I4%,K5%)=T#(I4%,K5%+1)
    NEXT K5%
  END IF
  U%(I4%,4)=0
  T1$(I4%,4)=" "
  L$(I4%,4)=" "
  S$(I4%,4)=" "
  T#(I4%,4)=0
  K4%=K4%-1
RETURN

DELETESUBAREA:
  LOCATE 21,17:PRINT "ENTER SUBAREA TO BE DELETED: ";:A$="A1":CALL PROM(A$,4,2)
  FOR I4%=1 TO I2%
    IF A$=A$(I4%) THEN LABEL5
  NEXT I4%
  GOTO EDITSUBAREAS
  LABEL5:
  FOR I% = I4% TO I2%-1
    A$(I%)=A$(I%+1)
    A5#(I%)=A5#(I%+1)
    C#(I%)=C#(I%+1)
    T8#(I%)=T8#(I%+1)
    A1$(I%)=A1$(I%+1)
    A2$(I%)=A2$(I%+1)
    A3$(I%)=A3$(I%+1)
    A4$(I%)=A4$(I%+1)
    I1$(I%)=I1$(I%+1)
    FOR K4% = 1 TO 4
      U%(I%,K4%)=U%(I%+1,K4%)
      T1$(I%,K4%)=T1$(I%+1,K4%)
      L$(I%,K4%)=L$(I%+1,K4%)
      S$(I%,K4%)=S$(I%+1,K4%)
      T#(I%,K4%)=T#(I%+1,K4%)
    NEXT K4%
  NEXT I%
    I2%=I2%-1
GOTO EDITSUBAREAS

INSERTSUBAREA:
  IF I2%>299 THEN
    CLS
    LOCATE 10,25:COLOR 15,0:PRINT STR$(MAXAREAS%);" SUBAREAS HAVE BEEN ENTERED"
    DELAY 3:COLOR 7,0
    GOTO EDITSUBAREAS
  END IF
  LOCATE 21,17:PRINT "ENTER SUBAREA TO BE INSERTED BEFORE: ";:A$="A1":CALL PROM(A$,4,2)
  FOR I4%=1 TO I2%
    IF A$=A$(I4%) THEN LABEL6
  NEXT I4%
  GOTO EDITSUBAREAS
  LABEL6:
    I2%=I2%+1
    FOR I% = I2% TO I4%+1 STEP -1
      A$(I%)=A$(I%-1)
      A5#(I%)=A5#(I%-1)
      C#(I%)=C#(I%-1)
      T8#(I%)=T8#(I%-1)
      A1$(I%)=A1$(I%-1)
      A2$(I%)=A2$(I%-1)
      A3$(I%)=A3$(I%-1)
      A4$(I%)=A4$(I%-1)
      I1$(I%)=I1$(I%-1)
      FOR K4% = 1 TO 4
        U%(I%,K4%)=U%(I%-1,K4%)
        T1$(I%,K4%)=T1$(I%-1,K4%)
        L$(I%,K4%)=L$(I%-1,K4%)
        S$(I%,K4%)=S$(I%-1,K4%)
        T#(I%,K4%)=T#(I%-1,K4%)
      NEXT K4%
    NEXT I%
      A$(I4%)=" "
      A5#(I4%)=0
      C#(I4%)=0
      T8#(I4%)=0
      A1$(I4%)=" "
      A2$(I4%)=" "
      A3$(I4%)=" "
      A4$(I4%)=" "
      I1$(I4%)=" "
      FOR K4% = 1 TO 4
        U%(I4%,K4%)=0
        T1$(I4%,K4%)=" "
        L$(I4%,K4%)=" "
        S$(I4%,K4%)=" "
        T#(I4%,K4%)=0
      NEXT K4%
      A$(I4%)="A1"
      IF I4%>1 THEN
        A9$=MID$(A$(I4%-1),2,4):A%=VAL(A9$):INCR A%
        A$(I4%)=MID$(A$(I4%-1),1,1)+MID$(STR$(A%),2,4)
      END IF
      NUM%=2:IF I2%=1 THEN NUM%=1
    LABEL7:
      GOSUB HEADING
      GOSUB EDITHEADING
      LOCATE 6,6:PRINT "ENTER SUBAREA DESIGNATION: ";:CALL PROM(A$(I4%),4,NUM%)
      LOCATE 6,6:PRINT "                                  "
      LOCATE 2,28:PRINT "                      "
      LOCATE 4,23:PRINT "                                              "
      GOSUB ENTERCVALUE1
      LOCATE 23,25:PRINT"ENTER 'N' TO EXIT ";:Z$="N":CALL PROM(Z$,1,1)
      IF Z$<>"N" THEN
        GOTO LABEL7
      END IF
      CLS:GOSUB HEADING:J%=1:K%=1:N2%=6
      LOCATE 3,34:PRINT "SUBAREA ";A$(I4%)
      LOCATE 4,17:PRINT "TIME OF CONCENTRATION - SCS VELOCITY METHOD"
      LOCATE 5,1 :PRINT FNBOX$(79,15)
GOTO START3
RETURN
