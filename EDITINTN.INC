REM RAINFALL INTENSITY EDITOR
'-----------------------------------------------------------------------------'

INTENSITYEDITOR:
INTENSITYMENU:
  GOSUB INTENSITYEDITHEADING
  LOCATE 8,19:PRINT FN BOX$(41,8)
  LOCATE 9,21:PRINT "ENTER DESIRED FUNCTION"
  LOCATE 11,23:PRINT "1) CREATE INTENSITY DATA FILE"
  LOCATE 12,23:PRINT "2) EDIT EXISTING INTENSITY DATA FILE"
  LOCATE 13,23:PRINT "3) EXIT INTENSITY DATA EDITOR"
  LOCATE 15,21:PRINT "NUMBER?"
  INTENSITYEDITENTER:
    LOCATE 15,29:Y1$="2":CALL PROM(Y1$,1,1)
    IF Y1$ = "1" THEN GOTO INTENSITYCREATE
    IF Y1$ = "2" THEN GOTO INTENSITYEDIT
    IF Y1$ = "3" THEN GOTO INTENSITYEXITROUTINE
  GOTO INTENSITYEDITENTER

INTENSITYEDITHEADING:
  CLS:COLOR 15,0
  LOCATE 1,25:PRINT "RAINFALL INTENSITY DATA EDITOR"
  COLOR 7,0
RETURN

INTENSITYINFOLINE:
  LOCATE 3,5:PRINT "ENTER NAME OF INTENSITY FILE: ";:CALL PROM(FF$,12,1)
RETURN

INTENSITYCREATE:
  GOSUB INTENSITYEDITHEADING
  GOSUB INTENSITYINFOLINE
  LOCATE 5,2:PRINT "MIN      2 YR      5 YR      10 YR     15 YR     25 YR     50 YR     100 YR"
  K%=1
  FOR I%=1 TO 50
    LOCATE K%+6,2:MIN$(I%) = " ":CALL PROM(MIN$(I%),4,1)
    FOR J%=1 TO 7
      LOCATE K%+6,1+10*J%:INTEN$(I%,J%) = " ":CALL PROM(INTEN$(I%,J%),5,1)
    NEXT J%
  INTENSITYMOREDATA:
  LOCATE 22,5:PRINT"ENTER MORE DATA? ";:Y1$="Y":CALL PROM(Y1$,1,1)
    IF Y1$="N" THEN GOTO INTENSITYENDCREATE
    IF Y1$="Y" THEN GOTO INTENSITYCONTCREATE
    GOTO INTENSITYMOREDATA
  INTENSITYCONTCREATE:
    IF K%=13 THEN
      K%=0:GOSUB INTENSITYEDITHEADING
      LOCATE 5,2:PRINT "MIN      2 YR      5 YR      10 YR     15 YR     25 YR     50 YR     100 YR"
    END IF
    INCR K%
  NEXT I%
INTENSITYENDCREATE:
  OPEN FF$ FOR OUTPUT AS #1
    WRITE #1, I%
    FOR I1% = 1 TO I%
      WRITE #1, MIN$(I1%)
      FOR J%=1 TO 7
        WRITE #1, INTEN$(I1%,J%)
      NEXT J%
    NEXT I1%
  CLOSE #1
GOTO INTENSITYMENU


INTENSITYEDIT:
  GOSUB INTENSITYEDITHEADING
  IF FF$=CHT$(0) THEN FF$="NJDEP.INT"
  GOSUB INTENSITYINFOLINE
  ON ERROR GOTO INTENSITYINPUTERROR
  OPEN FF$ FOR INPUT AS #1
    INPUT #1, I2%
    FOR I1% = 1 TO I2%
      INPUT #1, MIN$(I1%)
      FOR J%=1 TO 7
        INPUT #1, INTEN$(I1%,J%)
      NEXT J%
    NEXT I1%
  CLOSE #1
  I1%=1
  LOCATE 5,2:PRINT "MIN      2 YR      5 YR      10 YR     15 YR     25 YR     50 YR     100 YR"
  I3%=12:IF I2%<I3% THEN I3%=I2%-1    'I3% IS MAXIMUM VALUE FOR SCREEN
  FOR I%=1 TO I3%+1
    LOCATE I%+6,2:PRINT MIN$(I%)
    FOR J%=1 TO 7
      LOCATE I%+6,1+10*J%:PRINT INTEN$(I%,J%)
    NEXT J%
  NEXT I%
INTENSITYOPTIONSMENU:
  COLOR 15
  LOCATE 22,2:PRINT"F1 - EDIT      F2 - NEXT      F3 - PREVIOUS      F4 - APPEND      F5 - EXIT"
  COLOR 7
  INTENSITYEDITENTER1:
    D1$ = INKEY$
    IF (LEN(D1$)) <> 2 THEN INTENSITYEDITENTER1
    IF D1$ = CHR$(0)+CHR$(59) THEN GOTO INTENSITYEDIT1
    IF D1$ = CHR$(0)+CHR$(60) THEN GOTO INTENSITYNEXT1
    IF D1$ = CHR$(0)+CHR$(61) THEN GOTO INTENSITYPREVIOUS
    IF D1$ = CHR$(0)+CHR$(62) THEN GOTO INTENSITYADDVALUE
    IF D1$ = CHR$(0)+CHR$(63) THEN GOTO INTENSITYEXIT1
  GOTO INTENSITYEDITENTER1

INTENSITYINPUTERROR:
  LOCATE 10,5:COLOR 15:PRINT "FILE DOES NOT EXIST - REENTER!"
  DELAY 3:COLOR 7:LOCATE 10,5:PRINT "                               "
RESUME INTENSITYEDIT

INTENSITYEDIT1:
  LOCATE 22,2:PRINT"                                                                           "
  FOR I%=I1% TO I1%+I3%
    LOCATE I%-I1%+7,2:CALL PROM(MIN$(I%),4,1)
    FOR J%=1 TO 7
      LOCATE I%-I1%+7,10*J%+1:CALL PROM(INTEN$(I%,J%),5,1)
    NEXT J%
  NEXT I%
GOTO INTENSITYOPTIONSMENU

INTENSITYNEXT1:
  I1%=I1%+13
  IF I1%>I2% THEN
    I1%=I1%-13
    GOTO INTENSITYOPTIONSMENU
  END IF
  I3%=12
  IF (I3%+I1%-1) > I2% THEN I3% = I2%-I1%+1
  GOSUB INTENSITYPRINTVALUES1
GOTO INTENSITYEDITENTER1

INTENSITYPREVIOUS:
  IF I1%=1 THEN GOTO INTENSITYOPTIONSMENU
  I1% = I1%-13
  I3%=12
  GOSUB INTENSITYPRINTVALUES1
GOTO INTENSITYEDITENTER1

INTENSITYADDVALUE:
  LOCATE 22,2:PRINT"                                                                           "
  I1% = (INT(I2%/13))*13+1
  I3%=13
  IF (I3%+I1%-1) > I2% THEN I3% = I2%-I1%+1
  GOSUB INTENSITYPRINTVALUES1
  INCR I2%
  INCR I3%
  IF (I2%-I1%) > 12 THEN
    I1%=I1%+13
    I3%=1
    GOSUB INTENSITYPRINTVALUES1
  END IF
  LOCATE I3%+6,2:MIN$(I2%) = " ":CALL PROM(MIN$(I2%),4,1)
  FOR J%=1 TO 7
    LOCATE I3%+6,10*J%+1:INTEN$(I2%,J%) = " ":CALL PROM(INTEN$(I2%,J%),5,1)
  NEXT J%
GOTO INTENSITYOPTIONSMENU

INTENSITYEXIT1:
  GOSUB INTENSITYEDITHEADING
  LOCATE 10,5:PRINT "SAVE DATA? ";:Y1$="Y":CALL PROM$(Y1$,1,1)
  IF Y1$ <> "Y" THEN GOTO INTENSITYMENU
  OPEN FF$ FOR OUTPUT AS #1
    WRITE #1, I2%
    FOR I1% = 1 TO I2%
      WRITE #1, MIN$(I1%)
      FOR J%=1 TO 7
        WRITE #1, INTEN$(I1%,J%)
      NEXT J%
    NEXT I1%
  CLOSE #1
GOTO INTENSITYMENU

INTENSITYPRINTVALUES1:
  FOR I% = I1% TO I1%+I3%
    LOCATE I%-I1%+7,2:PRINT MIN$(I%)
    FOR J% = 1 TO 7
      LOCATE I%-I1%+7,10*J%+1:PRINT INTEN$(I%,J%)
    NEXT J%
  NEXT I%
  IF I3%<12 THEN
    FOR J% = I3%+1 TO 14
      LOCATE J%+6,2:PRINT "                                                                            "
    NEXT J%
  END IF
RETURN

INTENSITYEXITROUTINE:
RETURN
